(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4174:function(e,t,r){Promise.resolve().then(r.bind(r,1883))},1883:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return M}});var n=r(7358),i=r(9480),a=r(4852),l=r(5056),s=r(1863);function c(e){var t;return(0,n.jsxs)(a.k,{flexDir:"column",alignItems:"center",width:"100%",padding:"1rem",children:[(0,n.jsx)(l.X,{as:"h3",size:"lg",marginBottom:"1rem",alignSelf:"flex-start",children:e.title}),(0,n.jsx)(s.g,{width:"100%",margin:"1rem",padding:"1rem",border:"1px solid #ccc",borderRadius:"0.5rem",minHeight:"10rem",placeholder:e.placeholder,size:"lg",resize:"none",onChange:e.onChange,value:null===(t=e.value)||void 0===t?void 0:t.toString().toLowerCase()})]})}var o=r(878),d=r(5746);class u{set_quantity(e){let t=e.split(" ")[0].replace(",","");return parseInt(t.replace(/[0-9]x /,""))}set_card_name(e){let t=e.split(" ")[0],r=e.replace(t,"");return this.trim_meta_data(r).replace(/"/g,"")}trim_meta_data(e){if(e.includes("(")){let t=e.split("(")[0];return t.trim()}if(e.includes("[")){let t=e.split("[")[0];return t.trim()}return e.trim()}constructor(e){(0,d._)(this,"quantity",void 0),(0,d._)(this,"name",void 0),this.quantity=this.set_quantity(e),this.name=this.set_card_name(e)}}var m=function(e){let[t,r]=i.useState(""),[l,s]=i.useState("");function d(e){let t=e.split("\n"),r=new Map;return t.forEach(e=>{let t=new u(e);r.set(t.name,t.quantity)}),r}return(0,n.jsxs)(a.k,{flexDir:"column",alignItems:"center",width:{base:"100%",md:"50%"},children:[(0,n.jsxs)(a.k,{flexDir:"row",alignItems:"center",justifyContent:"center",width:"100%",children:[(0,n.jsx)(c,{placeholder:"Decklist",onChange:function(e){r(e.target.value.toString().toLowerCase())},title:"Decklist"}),(0,n.jsx)(c,{placeholder:"Collection",onChange:function(e){s(e.target.value.toString().toLowerCase())},title:"Collection"})]}),(0,n.jsx)(o.z,{colorScheme:"blue",size:"lg",className:"btn-primary",onClick:function(){let r=new Map,n=new Map,i=d(t),a=d(l);i.forEach((e,t)=>{if(a.has(t)){var i;let l=null!==(i=a.get(t))&&void 0!==i?i:0;if(l<e){let n={name:t,quantity:e-l};r.set(n.name,n.quantity)}else n.set(t,l)}else r.set(t,e)}),e.setMissingCards(r),e.setCollectionCards(n)},children:"Submit"})]})},h=function(e){let{cards:t,title:r}=e;return(0,n.jsxs)(a.k,{flexDir:"column",width:"100%",alignItems:"center",padding:"1rem",children:[(0,n.jsx)(l.X,{as:"h3",size:"lg",marginBottom:"1rem",alignSelf:"flex-start",children:r}),(0,n.jsx)(s.g,{width:"100%",padding:"1rem",border:"1px solid #ccc",borderRadius:"0.5rem",minHeight:"10rem",size:"lg",placeholder:"Output",value:Array.from(t).map(e=>{let[t,r]=e;return"".concat(r," ").concat(t)}).join("\n"),readOnly:!0,resize:"none"})]})},f=function(e){let{cards:t,collectionCards:r}=e;return(0,n.jsxs)(a.k,{style:{flexDirection:"column",alignItems:"center",textAlign:"center",color:"#2c3e50",margin:"1rem"},children:[(0,n.jsxs)(a.k,{flexFlow:{base:"column",md:"row"},justifyContent:"center",width:"100%",children:[(0,n.jsx)(h,{title:"Missing cards",cards:t}),(0,n.jsx)(h,{title:"In collection",cards:r})]}),(0,n.jsxs)(a.k,{children:[(0,n.jsx)(o.z,{colorScheme:"blue",size:"lg",className:"btn-primary",onClick:()=>{navigator.clipboard.writeText(Array.from(t).map(e=>"".concat(e[1]," ").concat(e[0])).join("\n"))},children:"Copy to clipboard"}),(0,n.jsx)(o.z,{colorScheme:"blue",size:"lg",className:"btn-primary",onClick:()=>{navigator.clipboard.writeText(JSON.stringify(Object.fromEntries(t),null,2))},children:"copy JSON"})]})]})},g=r(6268),x=r.n(g),p=r(9979),j=r(5566);let w=p.z.enum(["fatal","error","warn","info","debug","trace"]).default("info"),b=function(){let e=j.env.LOG_LEVEL?w.parse(j.env.LOG_LEVEL):w.parse("info"),t=x()({level:e});return t}();var y=r(8826),C=r.n(y);class _{async getCard(e){let t=await C()("".concat(_.base_url,"/cards/named?exact=").concat(e));return await t.json()}async getCardImageUri(e){let t=await this.getCard(e);return t.image_uris.large}async getcardBulk(e){let t=JSON.stringify({identifiers:e.map(e=>({name:e}))}),r=await C()("".concat(_.base_url,"/cards/collection"),{method:"POST",body:t,headers:{"Content-Type":"application/json"}}),n=await r.json();return n.data}async fetchBulkData(e){if(0===e.length)return[];let t=[],r=async e=>{let r=e.map(e=>e.name);try{let e=await this.getcardBulk(r);t.push(...e)}catch(e){b.error("Error fetching cards from scryfall: ".concat(e))}};if(e.length>75)for(let t=0;t<e.length;t+=75){let n=e.slice(t,t+75);await r(n)}else await r(e);return t}async getReprints(e){let t=await C()(e),r=await t.json();return r.data}}(0,d._)(_,"base_url","https://api.scryfall.com");var k=r(702),v=r(5625),S=r(2594),z=r(9665),E=r(4059),D=r(53),O=r(8593),I=r(1942);let q=e=>{let{card:t,isOpen:r,onClose:s}=e,[c,o]=i.useState([]);return(0,i.useEffect)(()=>{let e=new _;r&&t.reprint&&e.getReprints(t.prints_search_uri).then(e=>{o([...e])})},[r,t.id]),(0,n.jsxs)(S.u_,{isOpen:r,onClose:s,children:[(0,n.jsx)(z.Z,{sx:{backdropFilter:"blur(10px)",background:"rgba(255, 255, 255, 0.5)"}}),(0,n.jsxs)(E.h,{overflow:"scroll",children:[(0,n.jsx)(D.o,{alignSelf:"flex-end",padding:"2rem"}),(0,n.jsx)(O.f,{children:(0,n.jsxs)(a.k,{flexDir:{base:"column",md:"row"},flexFlow:"wrap",justifyContent:"center",alignItems:"space-between",overflow:"auto",children:[(0,n.jsx)("img",{src:t.image_uris.normal,alt:t.name}),(0,n.jsx)(I.xu,{bg:"white",margin:"2rem",padding:"2rem",borderRadius:"1rem",maxH:"60vh",overflow:"auto",maxW:"50em",children:(0,n.jsxs)(a.k,{flexDir:"column",justifyContent:"top",alignItems:"center",textAlign:"left",children:[(0,n.jsx)(l.X,{as:"h2",fontWeight:"bold",fontSize:"2em",margin:"2rem",children:t.name}),(0,n.jsxs)(a.k,{flexDir:"column",children:[(0,n.jsx)("p",{children:t.oracle_text}),(0,n.jsx)("p",{children:t.flavor_text}),c.length>0&&(0,n.jsxs)("div",{children:[(0,n.jsx)("br",{}),(0,n.jsx)("b",{children:"Reprints:"}),c.map(e=>(0,n.jsx)("p",{children:e.set_name}))]})]})]})})]})})]})]})},L=e=>{let{cards:t}=e,{isOpen:r,onOpen:i,onClose:l}=(0,k.q)();return(0,n.jsxs)(a.k,{id:t.id,flexDir:"column",alignItems:"left",margin:"0.4em",onClick:i,children:[(0,n.jsx)(q,{isOpen:r,card:t,onClose:l}),(0,n.jsx)("button",{onClick:i,children:(0,n.jsx)(v.E,{src:t.image_uris.large,alt:t.name,width:"200",height:"280",margin:"0 auto",border:"1px solid #ccc",borderRadius:"5px"})})]},t.id)},N=e=>{let{cards:t}=e,[r,l]=i.useState([]);return(0,i.useEffect)(()=>{let e=async()=>{let e=new _,r=[];t.forEach((e,t)=>{r.push({name:t,quantity:e})});let n=await e.fetchBulkData(r);l(n)};e()},[t]),(0,n.jsx)(a.k,{flexWrap:"wrap",justifyContent:"center",children:r.map(e=>(0,n.jsx)(L,{cards:e},e.id))})};var M=function(){let[e,t]=i.useState(new Map),[r,l]=i.useState(new Map);return(0,n.jsxs)(a.k,{flexDir:"column",width:{base:"100%",md:"50%"},children:[(0,n.jsx)(m,{setMissingCards:t,setCollectionCards:l}),e.size>0&&(0,n.jsx)(f,{cards:e,collectionCards:r}),(0,n.jsx)(N,{cards:e})]})}}},function(e){e.O(0,[853,527,720,170,744],function(){return e(e.s=4174)}),_N_E=e.O()}]);